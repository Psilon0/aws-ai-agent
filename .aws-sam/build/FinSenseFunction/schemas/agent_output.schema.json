{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AgentOutput",
  "type": "object",
  "required": ["status", "messages", "analytics", "advice", "latency_ms", "run_id"],
  "properties": {
    "status": { "type": "string", "enum": ["ok", "error"] },
    "run_id": { "type": "string" },
    "messages": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["role", "content"],
        "properties": {
          "role": { "type": "string" },
          "content": { "type": "string" }
        },
        "additionalProperties": true
      }
    },
    "analytics": { "type": "object" },
    "allocation": {
      "type": "object",
      "properties": {
        "equities": { "type": "number" },
        "bonds":    { "type": "number" },
        "cash":     { "type": "number" }
      },
      "additionalProperties": true
    },
    "kpis": {
      "type": "object",
      "properties": {
        "exp_return_1y": { "type": "number" },
        "exp_vol_1y":    { "type": "number" },
        "max_drawdown":  { "type": "number" }
      },
      "additionalProperties": true
    },
    "advice": {
      "type": "object",
      "required": ["summary", "one_action", "disclaimer"],
      "properties": {
        "summary":    { "type": "string", "maxLength": 2000 },
        "one_action": { "type": "string" },
        "disclaimer": { "type": "string" }
      },
      "additionalProperties": false
    },
    "latency_ms": { "type": "number" }
  },
  "additionalProperties": true
}
