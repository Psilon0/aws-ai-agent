{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "AgentOutput",
  "type": "object",
  "required": ["version","run_id","latency_ms","advice","allocation","kpis","sentiment"],
  "properties": {
    "version": {"type":"string"},
    "run_id": {"type":"string"},
    "latency_ms": {"type":"integer","minimum":0},
    "advice": {
      "type":"object",
      "required": ["summary","one_action","disclaimer"],
      "properties": {
        "summary": {"type":"string","maxLength": 1200},
        "one_action": {"type":"string","maxLength": 240},
        "disclaimer": {"type":"string"}
      }
    },
    "allocation": {
      "type":"object",
      "required":["equities","bonds","cash"],
      "properties": {
        "equities":{"type":"number","minimum":0,"maximum":1},
        "bonds":{"type":"number","minimum":0,"maximum":1},
        "cash":{"type":"number","minimum":0,"maximum":1}
      }
    },
    "allocation_meta": {
      "type":"object",
      "properties": {
        "band": {
          "type":"object",
          "required": ["min_eq","max_eq"],
          "properties": {
            "min_eq":{"type":"number","minimum":0,"maximum":1},
            "max_eq":{"type":"number","minimum":0,"maximum":1}
          }
        }
      }
    },
    "kpis": {
      "type":"object",
      "required":["exp_return_1y","exp_vol_1y","max_drawdown"],
      "properties": {
        "exp_return_1y":{"type":"number"},
        "exp_vol_1y":{"type":"number"},
        "max_drawdown":{"type":"number"}
      }
    },
    "sentiment": {
      "type":"object",
      "required":["label","confidence","asof_iso"],
      "properties": {
        "label":{"enum":["bullish","neutral","bearish"]},
        "confidence":{"type":"number","minimum":0,"maximum":1},
        "asof_iso":{"type":"string"}
      }
    },
    "risk_alerts": {
      "type":"array",
      "items":{"type":"object"}
    },
    "advanced_payload": {
      "type":"object"
    }
  }
}
