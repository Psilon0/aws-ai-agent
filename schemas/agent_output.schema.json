{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "agent_output.schema.json",
  "type": "object",
  "required": ["advice","analytics","kpis","run_id","latency_ms"],
  "properties": {
    "advice": {
      "type": "object",
      "required": ["summary","one_action","disclaimer"],
      "properties": {
        "summary": { "type": "string", "minLength": 1, "maxLength": 1800 },
        "one_action": { "type": "string", "minLength": 1, "maxLength": 200 },
        "disclaimer": { "type": "string", "minLength": 1, "maxLength": 200 }
      },
      "additionalProperties": false
    },
    "analytics": {
      "type": "object",
      "required": ["proposed_allocation"],
      "properties": {
        "proposed_allocation": {
          "type": "object",
          "required": ["equities","bonds","cash"],
          "properties": {
            "equities": {"type":"number","minimum":0,"maximum":1},
            "bonds":    {"type":"number","minimum":0,"maximum":1},
            "cash":     {"type":"number","minimum":0,"maximum":1}
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": true
    },
    "kpis": {
      "type":"object",
      "required":["exp_return_1y","exp_vol_1y","max_drawdown"],
      "properties":{
        "exp_return_1y":{"type":"number"},
        "exp_vol_1y":{"type":"number"},
        "max_drawdown":{"type":"number"}
      },
      "additionalProperties": false
    },
    "sentiment": {
      "type":"object",
      "properties":{
        "label":{"type":"string","enum":["bearish","slightly_bearish","neutral","slightly_bullish","bullish"]},
        "confidence":{"type":"number","minimum":0,"maximum":1}
      },
      "additionalProperties": false
    },
    "risk_alerts": {
      "type":"array",
      "items":{
        "type":"object",
        "required":["type","severity","evidence","suggested_action"],
        "properties":{
          "type":{"type":"string"},
          "severity":{"type":"string","enum":["low","medium","high"]},
          "evidence":{"type":"string"},
          "suggested_action":{"type":"string"}
        },
        "additionalProperties": false
      }
    },
    "run_id":{"type":"string"},
    "latency_ms":{"type":"integer","minimum":0}
  },
  "additionalProperties": true
}
